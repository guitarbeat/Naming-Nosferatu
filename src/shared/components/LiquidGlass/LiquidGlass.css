.liquid-glass {
  position: relative;
  /* * Use specified radius, but cap at half height to prevent over-rounding for tall elements */
  border-radius: min(
    calc(var(--radius, 999) * 1px),
    calc(var(--height, 80) * 0.5 * 1px)
  );
  overflow: hidden;
  z-index: 1;
}

/* * When used for navbar, ensure it's fixed and visible */
.app-navbar-glass.liquid-glass {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: var(--z-sticky, 1020);
}

.app-navbar-glass.liquid-glass::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background:
    radial-gradient(
      120% 120% at 10% 10%,
      color-mix(in srgb, var(--glass-bg-strong, rgb(15 23 42 / 70%)) 80%, transparent),
      transparent 72%
    ),
    linear-gradient(
      140deg,
      color-mix(in srgb, var(--glass-bg, rgb(15 23 42 / 55%)) 75%, transparent) 0%,
      color-mix(in srgb, var(--glass-bg-strong, rgb(15 23 42 / 80%)) 65%, transparent) 55%,
      color-mix(in srgb, var(--glass-bg, rgb(15 23 42 / 65%)) 55%, transparent) 100%
    );
  opacity: 0.45;
  z-index: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
}

.liquid-glass-content {
  width: 100%;
  height: 100%;
  position: relative;
  z-index: 2;
  border-radius: inherit;
}

.liquid-glass-filter {
  width: 100%;
  height: 100%;
  pointer-events: none;
  position: absolute;
  inset: 0;
  z-index: 1;
}

.liquid-glass {
  /* * Frost effect: subtle background tint for better visual separation */
  background: light-dark(
    hsl(0deg 0% 100% / var(--frost, 0)),
    hsl(0deg 0% 0% / var(--frost, 0))
  );

  /* * Liquid glass uses backdrop-filter with SVG filter for refraction effect */
  /* * Note: backdrop-filter with url() is set via JavaScript for browser compatibility */
  backdrop-filter: var(--backdrop-filter, blur(8px) saturate(1));

  /* * Subtle glass-like shadows */
  box-shadow:
    /* Inner highlights */
    0 0 2px 1px
      light-dark(
        color-mix(in oklch, canvasText, #0000 85%),
        color-mix(in oklch, canvasText, #0000 65%)
      )
      inset,
    0 0 10px 4px
      light-dark(
        color-mix(in oklch, canvasText, #0000 90%),
        color-mix(in oklch, canvasText, #0000 85%)
      )
      inset,
    /* Outer depth shadows */ 0 4px 16px rgb(17 17 26 / 5%),
    0 8px 24px rgb(17 17 26 / 5%),
    0 16px 56px rgb(17 17 26 / 5%);
}

.liquid-glass * {
  pointer-events: auto;
}

.displacement-image-container {
  position: absolute;
  width: 0;
  height: 0;
  overflow: hidden;
  opacity: 0;
  pointer-events: none;
}

@media (width <= 960px) {
  .app-navbar-glass.liquid-glass::before {
    opacity: 0.65;
  }
}

@media (prefers-reduced-transparency: reduce) {
  .app-navbar-glass.liquid-glass::before {
    opacity: 0.8;
  }
}

@supports not ((-webkit-backdrop-filter: blur(1px)) or (backdrop-filter: blur(1px))) {
  .liquid-glass {
    background: color-mix(
      in srgb,
      var(--glass-bg-strong, rgb(15 23 42 / 80%)) 80%,
      rgb(6 11 22 / 90%)
    );
    box-shadow:
      0 8px 24px rgb(0 0 0 / 28%),
      0 2px 8px rgb(0 0 0 / 12%);
  }

  .app-navbar-glass.liquid-glass::before {
    opacity: 0.92;
    background: linear-gradient(
      150deg,
      color-mix(in srgb, var(--glass-bg, rgb(15 23 42 / 75%)) 90%, transparent),
      color-mix(in srgb, var(--glass-bg-strong, rgb(15 23 42 / 90%)) 85%, transparent)
    );
  }
}
